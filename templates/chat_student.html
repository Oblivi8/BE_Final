<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/style3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
        integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
		    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://kit.fontawesome.com/yourcode.js" crossorigin="anonymous"></script>
    <title>Home</title>
    <link rel="stylesheet" href="/static/chatbot.css">
    <link rel="stylesheet" href="/static/assets/css/chat.css">
	      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
 
	    <style>
		
        #data-container {
            margin-bottom: 20px;
        }
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

:root {
    --primary-bg: #f8f9fa;
    --primary-border: #ccc;
    --hover-bg: #e9ecef;
    --text-color: #333;
    --font-family: 'Roboto', sans-serif;
    --box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    --transition: 0.3s ease;
    --border-radius: 8px;
    --side-panel-width: 300px;
    --side-panel-collapsed-width: 50px;
}

body {
    font-family: var(--font-family);
    color: var(--text-color);
}

.chat-container {
    margin: 20px auto; /* Center horizontally */
    max-width: 1300px;
    padding: 20px;
    background-color: #f5f5f5;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
}

#chat-messages {
    height: 255px;
    overflow-y: scroll;
    border-bottom: 1px solid var(--primary-border);
    margin-bottom: 10px;
}

#user-input {
    width: 100%;
    padding: 5px;
}

.side-panel {
    position: fixed;
    top: 90px;
    right: 0;
    width: var(--side-panel-width);
    height: 100%;
    background-color: var(--primary-bg);
    padding: 20px;
    overflow-y: auto;
    z-index: 1000;
    border-left: 1px solid var(--primary-border);
    box-shadow: var(--box-shadow);
    transition: width var(--transition);
    border-radius: var(--border-radius);
}

.side-panel.collapsed {
    width: var(--side-panel-collapsed-width); /* Width when collapsed */
}

.panel-content {
    display: flex;
    flex-direction: column;
}

.toggle-button {
    margin-top: auto;
    cursor: pointer;
}

.student-item {
    cursor: pointer;
    margin-bottom: 10px;
    padding: 10px;
    border-radius: var(--border-radius);
    transition: background-color var(--transition);
}

.student-item:hover {
    background-color: var(--hover-bg);
}

.panel-section {
    margin-bottom: 15px;
}

label {
    font-weight: bold;
}

input[type="text"],
select {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 3px;
    box-sizing: border-box;
    font-size: 14px;
}

select {
    cursor: pointer;
}
.profile-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #f9f9f9;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    width: 500px;
    max-width: 80%;
}

.popup-content {
    text-align: left;
}

.profile-header {
    margin-bottom: 20px;
}

.profile-header img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    margin-bottom: 10px;
}

.close-button {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    color: #777;
}

.close-button:hover {
    color: red;
}

#profile-details {
    margin-top: 20px;
}

#profile-details p {
    margin-bottom: 10px;
}

#linkedin-link,
#instagram-link {
    color: blue;
    text-decoration: none;
}

#linkedin-link:hover,
#instagram-link:hover {
    text-decoration: underline;
}

   .chat-popup {
    position: fixed;
    top: 55%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #c4def6;
    border: 1px solid #ccc;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
    padding: 10px;
    z-index: 1000;
    width: 400px; /* Set fixed width */
    height: 560px; /* Set fixed height */
    display: none;
}


    .chat-container {
        /* Add your styles for the chat container */
    }

    .info-section {
        /* Add your styles for the info section */
    }

    /* Style for the Start Chat button */
    #start-chat-btn {
        background-color: #007bff;
        color: #c4def6;
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        border-radius: 5px;
    }

    #start-chat-btn:hover {
        background-color: #0056b3;
    }
.popup-button {
    background-color: #007bff;
    color: #c4def6;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 5px;
    margin-right: 10px; /* Optional: Add margin between buttons */
}

.popup-button:hover {
    background-color: #0056b3;
}
#show-profile-btn {
     background-color: #007bff;
    color: #c4def6;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 5px;
    margin-right: 10px; /* Optional: Add margin between buttons */
}

#show-profile-btn:hover {
    background-color: #d39e00; /* Darker shade of yellow */
}
.instagram-feed {
    width: 70%;
    margin-left: 20px; /* Adjust the left margin as needed */
    margin-top: 20px; /* Adjust the top margin as needed */
}


@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

:root {
    --post-border-color: #ddd; /* Softer border color */
    --post-padding: 20px;
    --spacing: 20px;
    --font-weight-bold: 700;
    --font-color: #333; /* Darker text color for better readability */
    --font-family: 'Roboto', sans-serif; /* Custom font */
    --box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3), 5px 5px 20px rgba(0, 0, 0, 0.1) inset; /* 3D box shadow */
    --box-shadow-hover: 10px 10px 20px rgba(0, 0, 0, 0.4), 10px 10px 25px rgba(0, 0, 0, 0.15) inset; /* Deeper shadow on hover */
    --border-radius: 10px; /* Rounded corners for a modern look */
    --gradient-color: linear-gradient(to right, #ff7e5f, #feb47b); /* Gradient color */
    --background-color: #f8f8f8; /* Light background color */
    --text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3); /* Text shadow for 3D effect */
    --text-shadow-depth: 2px 2px 3px rgba(0, 0, 0, 0.6), 4px 4px 5px rgba(0, 0, 0, 0.3); /* Deeper 3D text shadow */
}

.post {
    margin-bottom: var(--spacing); /* Consistent spacing between posts */
    border: 1px solid var(--post-border-color); /* Subtle border around posts */
    padding: var(--post-padding); /* Consistent padding inside posts */
    border-radius: var(--border-radius); /* Rounded corners for a modern look */
    box-shadow: var(--box-shadow); /* 3D shadow for depth */
    background-color: var(--background-color); /* Light background color */
    font-family: var(--font-family); /* Apply custom font */
    transform: translateY(-5px); /* Slightly lifted effect */
    transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth transition */
}

.post:hover {
    transform: translateY(-10px); /* More lifted on hover */
    box-shadow: var(--box-shadow-hover); /* Deeper shadow on hover */
}

.profile-name {
    font-weight: var(--font-weight-bold);
    margin-bottom: 10px; /* Consistent spacing below profile name */
    font-size: 1.2em; /* Slightly larger font size */
    background: var(--gradient-color); /* Gradient color */
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: var(--text-shadow); /* Apply text shadow for 3D effect */
}

.post-content p {
    margin-bottom: 10px; /* Consistent spacing between paragraphs */
    line-height: 1.6; /* Improved line height for readability */
    font-family: var(--font-family); /* Apply custom font */
    background: var(--gradient-color); /* Gradient color */
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: var(--text-shadow); /* Apply text shadow for 3D effect */
}



.image-container {
    display: flex;
    justify-content: space-between; /* Arrange images evenly spaced */
    margin-bottom: 10px; /* Add spacing below image container */
}

.image-container img {
    width: 48%; /* Adjust width of images */
    max-height: 200px; /* Limit height of images */
}

.post-content a {
    color: blue; /* Change link color */
    text-decoration: underline; /* Underline links */
}

.popup {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.5);
}

.popup-content {
  background-color: #fefefe;
  margin: 5% auto;
  padding: 5px;
  border: 1px solid #888;
  width: 80%;
}
.popup-contentt {
  background-color: #fefefe;
  margin: 20% auto;
  padding: 21px;
  border: 1px solid #888;
  width: 47%;
}
.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

#add-blog-button {
  background-color: #4CAF50; /* Green background */
  border: none;
  color: white; /* White text */
  padding: 15px 32px; /* Padding */
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 20px; /* Add margin */
  cursor: pointer; /* Cursor style */
}
     .dropdown-menu {
            z-index: 1050; /* Higher than default navbar */
        }
        .position-relative .position-absolute {
            width: 12px;
            height: 12px;
        }
		
		body {
    margin: 0;
    font-family: var(--bs-body-font-family);
    font-size: var(--bs-body-font-size);
    font-weight: var(--bs-body-font-weight);
    line-height: var(--bs-body-line-height);
    color: var(--bs-body-color);
    text-align: var(--bs-body-text-align);
    background-color: #c4def6;
    -webkit-text-size-adjust: 100%;
    -webkit-tap-highlight-color: transparent;
}
    </style>
</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container-fluid" style="margin: 0% 5%;">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="d-flex justify-content-between align-items-center w-100">
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0 d-flex w-100">
                        <li class="nav-item flex-fill">
                            <a class="nav-link p-3 fs-7" aria-current="page" href="{{ url_for('student', role='student') }}">Home</a>
                        </li>
                        <li class="nav-item flex-fill">
                            <a class="nav-link p-3 fs-7" aria-current="page" onclick="scrollSection('resume-builder')" href="/resume_template?username={{ username }}">Resume Builder</a>
                        </li>
                        <li class="nav-item flex-fill">
                            <a class="nav-link p-3 fs-7" href="/chat_student?username={{ username }}">Alumni Connect</a>
                        </li>
                        <li class="nav-item flex-fill">
                            <a class="nav-link p-3 fs-7" href="/project_status?username={{ username }}" onclick="scrollSection('project-status')">Project Update</a>
                        </li>
                        <li class="nav-item flex-fill">
                            <a class="nav-link p-3 fs-7" href="/faq_student?username={{ username }}" onclick="scrollSection('FAQ')">FAQ</a>
                        </li>
						  <li class="nav-item flex-fill">
    <a class="nav-link p-3 fs-7" href="/options" onclick="scrollSection('ai')">AI</a>
</li>
                        <li class="nav-item flex-fill">
                            <a class="nav-link p-3 fs-7" href="/" onclick="scrollSection('FAQ')">LogOut</a>
                        </li>
                    </ul>
                </div>
                <!-- Profile box with square shape -->
                <div class="d-flex align-items-center">
                    <div class="dropdown">
                        <button class="btn btn-secondary position-relative" type="button" id="notificationDropdown" data-bs-toggle="dropdown" aria-expanded="false" onclick="removeNotificationDot()">
                            <i class="bi bi-bell"></i> <!-- Notification icon (using Bootstrap Icons) -->
                            <!-- Notification Badge -->
                            <span id="notificationBadge" class="position-absolute top-0 start-100 translate-middle p-1 bg-danger border border-light rounded-circle">
                                <span class="visually-hidden">New alerts</span>
                            </span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end p-3" aria-labelledby="notificationDropdown" style="min-width: 300px;">
                            <li><h6 class="dropdown-header">Notifications</h6></li>
                            <li><hr class="dropdown-divider"></li>
                            <!-- Placeholder for notifications -->
                            <li id="notificationList"></li>
                        </ul>
                    </div>
                    <div class="ms-3">
                        <div class="profile-box bg-primary text-white rounded p-2">
                            <p class="mb-0">WELCOME</p>
                            <p class="mb-0">{{ username }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

    <script>
        function removeNotificationDot() {
            // Remove the notification badge
            document.getElementById('notificationBadge').style.display = 'none';
            
            // Make an AJAX request to get notifications
			  var username = "{{ username }}"; // Replace with actual username
  
              fetch(`/get_notifications?username=${encodeURIComponent(username)}`)
                .then(response => response.json())
                .then(data => {
                    const notificationList = document.getElementById('notificationList');
                    notificationList.innerHTML = ''; // Clear any existing notifications
                    data.forEach(notification => {
                        const notificationItem = document.createElement('li');
                        notificationItem.className = 'dropdown-item';
                        notificationItem.textContent = notification;
                        notificationList.appendChild(notificationItem);
                    });

                    // Open the dropdown menu
                    const dropdown = new bootstrap.Dropdown(document.getElementById('notificationDropdown'));
                    dropdown.show();
                });
        }
    </script>
    <!-- Bootstrap JS (including Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>


<!-- Include Bootstrap Icons CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

  

<!-- Profile popup window -->
<div class="profile-popup" style="display: none;">
    <div class="popup-content">
        <button class="cancel-button">Cancel</button>
        <!-- Profile content will be displayed here -->
        <h5>Profile Name</h5>
        <p>Profile Description</p>
    </div>
</div>

<div class="chat-popup" id="chat-popup" style="display: none;">
    <button class="close-button" onclick="closeChatPopup()">×</button>
    <div class="chat-container">
        <div class="info-section">
            <h3>Chat With</h3>
            <h4 id="selected-student-name"></h4>
        </div>
        <div id="data-container"></div>
        <div id="chat-messages"></div>
        <form id="chat-form">
            <input type="text" class="message" id="message-input" placeholder="Type your message" required />
            <input type="submit" value="Send" />
        </form>
    </div>
</div>



    <script src="chat_script.js"></script>      
               
<div class="side-panel" id="side-panel">
    <div class="panel-content">
        <div class="panel-section">
            <label for="privacy-dropdown">Privacy:</label>
            <select id="privacy-dropdown">
                <option value="public">Public</option>
                <option value="private">Private</option>
            </select>
        </div>
        <div class="panel-section">
            <label for="search-bar">Search Alumni:</label>
            <input type="text" id="search-bar" placeholder="Search by Name" oninput="updateDropdown()" />
        </div>
        <div class="panel-section">
            <label for="student-dropdown"></label>
            <select id="student-dropdown"></select>
        </div>
        <!-- Add the "Show Profile" button inside the side panel -->
        <div class="panel-section">
            <button id="show-profile-btn" disabled>Show Profile</button>
     
            <button id="start-chat-btn" onclick="toggleChatPopup()">Start Chat</button>
			
        </div>
		  
    </div>
</div>

<div class="profile-popup" id="profile-popup" style="display: none;">
    <div class="popup-content">
        <button class="close-button" onclick="closeProfilePopup()">×</button>
        <div class="profile-header">
            <img id="profile-photo" src="https://randomuser.me/api/portraits/men/75.jpg" alt="Profile Photo">
            <h3>Profile Details</h3>
        </div>
        <div id="profile-details">
            <p id="profile-name"></p>
            <p id="profile-email"></p>
            <p><a id="linkedin-link" target="_blank">LinkedIn</a></p>
            <p><a id="instagram-link" target="_blank">Instagram</a></p>
            <!-- Add more profile details as needed -->
        </div>
    </div>
</div>

<!-- Button to trigger the blog popup -->
<button id="add-blog-button">Add Post</button>

<!-- Blog popup -->
<div id="blog-popup" class="popup" style="display: none;">
  <div class="popup-contentt">
    <span class="close">&times;</span>
    <h2>Add Post</h2>
    <form id="blog-form">
      <label for="blog-title">Title:</label><br>
      <input type="text" id="blog-title" name="blog-title"><br>
      <label for="blog-description">Description:</label><br>
      <textarea id="blog-description" name="blog-description"></textarea><br>
      <label for="blog-link">Link:</label><br>
      <input type="text" id="blog-link" name="blog-link"><br>
      <input type="submit" value="Submit">
    </form>
  </div>
</div>

<div class="instagram-feed">
    <div class="post">
        <div class="profile-name">John Doe</div>
        <div class="post-content">
            <p>This is a sample blog post. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla vestibulum magna sit amet urna sollicitudin, at fermentum justo lacinia.</p>
            <p>Here's a link to the blog: <a href="sample-blog-link1" target="_blank">Sample Blog 1</a></p>
        </div>
    </div>
    <div class="post">
        <div class="profile-name">Jane Smith</div>
        <div class="post-content">
            <p>This is another sample blog post. Curabitur sit amet mauris volutpat, venenatis ipsum et, fringilla metus.</p>
            <div class="image-container">
                <img src="sample-image1.jpg" alt="Sample Image 1">
                <img src="sample-image2.jpg" alt="Sample Image 2">
           </div>
             <p>Here's a job referral link: <a href="job-referral-link" target="_blank">Job Referral</a></p>
        </div>
    </div>

</div>
    <script>
        // Function to make an AJAX request to the server
        function fetchData() {
            // Send an AJAX request to the '/fetch-data' route
            fetch('/instagram-feed')
                .then(response => response.json())
                .then(data => {
                    console.log("Data received from server:", data);
                    displayPosts(data);
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        // Function to display posts in the Instagram feed
  function displayPosts(data) {
    // Reference to the Instagram feed container
    const feedContainer = document.querySelector('.instagram-feed');

    // Iterate through each post in the data
    data.blog_posts.forEach(post => {
        // Create elements for each post
        const postElement = document.createElement('div');
        postElement.classList.add('post');

        const profileName = document.createElement('div');
        profileName.classList.add('profile-name');
        profileName.textContent = post.username;

        const postContent = document.createElement('div');
        postContent.classList.add('post-content');

        const title = document.createElement('h3');
        title.textContent = post.title;

        const description = document.createElement('p');
        description.textContent = post.description;

        // Create the link element
        const link = document.createElement('a');
        link.textContent = "Read more";

        // Check if the link is absolute
        if (post.link.startsWith('http://') || post.link.startsWith('https://')) {
            // If the link is already absolute, use it as is
            link.href = post.link;
        } else {
            // If the link is relative, prepend it with 'http://' to make it absolute
            link.href = 'http://' + post.link;
        }

        link.target = "_blank";

        // Append elements to the post container
        postContent.appendChild(title);
        postContent.appendChild(description);
        postContent.appendChild(link);

        postElement.appendChild(profileName);
        postElement.appendChild(postContent);

        // Append the post element to the Instagram feed container
        feedContainer.appendChild(postElement);
    });
}

        // Call fetchData() function directly after the script loads
        fetchData();
    </script>
<script>
document.getElementById("add-blog-button").addEventListener("click", function() {
  document.getElementById("blog-popup").style.display = "block";
});

document.querySelector(".close").addEventListener("click", function() {
  document.getElementById("blog-popup").style.display = "none";
});

document.getElementById("blog-form").addEventListener("submit", function(event) {
  event.preventDefault();
  var title = document.getElementById("blog-title").value;
  var description = document.getElementById("blog-description").value;
  var link = document.getElementById("blog-link").value;
  
  // Get username
  var username = "{{ username }}"; // Replace with actual username
  
  // Add new post to Instagram feed
  var feed = document.querySelector(".instagram-feed");
  var newPost = document.createElement("div");
  newPost.classList.add("post");
  newPost.innerHTML = '<div class="profile-name">' + username + '</div>' +
                      '<div class="post-content">' +
                      '<h3>' + title + '</h3>' +
                      '<p>' + description + '</p>' +
                      '<p>Link: <a href="' + link + '" target="_blank">' + link + '</a></p>' +
                      '</div>';
  feed.appendChild(newPost);
  
  // Fetch request to submit the blog
  fetch('/submit_blog', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      username: username,
      'blog-title': title,
      'blog-description': description,
      'blog-link': link,
    }),
  })
  .then(response => response.json())
  .then(data => {
    console.log(data);
    // Optionally, you can display a success message or update the UI here
  })
  .catch(error => {
    console.error('Error:', error);
    // Handle error if needed
  });
  
  // Close popup
  document.getElementById("blog-popup").style.display = "none";
});
</script>



<script>    






function closeChatPopup() {
    document.getElementById("chat-popup").style.display = "none";
}

   function toggleChatPopup() {
        var chatPopup = document.getElementById("chat-popup");
        if (chatPopup.style.display === "none") {
            // Show the chat popup window
            chatPopup.style.display = "block";
        } else {
            // Hide the chat popup window
            chatPopup.style.display = "none";
        }
    }
  function startChat() {
    // Show the chat container
    document.getElementById("chat-container").style.display = "block";
    
    // Optionally, you can scroll to the chat container for better user experience
    document.getElementById("chat-container").scrollIntoView({ behavior: "smooth" });
}
// JavaScript to enable the button when a student is selected and show the pop-up window when the button is clicked
document.getElementById("student-dropdown").addEventListener("change", function() {
    // Get the selected student's name
    const selectedStudentName = document.getElementById("student-dropdown").value;
    
    // Display the selected student's name in the info section
    document.getElementById("selected-student-name").innerText = "" + selectedStudentName;

    const selectedStudent = document.getElementById("student-dropdown").value;
    const showProfileBtn = document.getElementById("show-profile-btn");
    if (selectedStudent) {
        showProfileBtn.disabled = false;
    } else {
        showProfileBtn.disabled = true;
    }
});

// Event listener for the "Show Profile" button click
document.getElementById("show-profile-btn").addEventListener("click", function() {
    const selectedStudentEmail = document.getElementById("student-dropdown").value;
    
    // Extract the name from the email (assuming the email format is 'name@example.com')
    const name = selectedStudentEmail.split("@")[0];
    
    // Generate LinkedIn and Instagram links based on the student's name
    const linkedInLink = "https://www.linkedin.com/in/" + name;
    const instagramLink = "https://www.instagram.com/" + name;
    
    // Update the popup content with the extracted name and links
    document.getElementById("profile-name").innerText = "User Name: " + name;
    document.getElementById("profile-email").innerText = "Email: " + selectedStudentEmail;
    document.getElementById("linkedin-link").setAttribute("href", linkedInLink);
    document.getElementById("instagram-link").setAttribute("href", instagramLink);
    
    // Show the popup window
    document.getElementById("profile-popup").style.display = "block";
});


function closeProfilePopup() {
    document.getElementById("profile-popup").style.display = "none";
}
 
    // Define a function to add a message to the chat
    function addMessage(from, message, timestamp) {
        var chatMessages = document.getElementById("chat-messages");
        var messageDiv = document.createElement("div");
        messageDiv.innerHTML = "<strong>" + from + ":</strong> " + message + " (" + timestamp + ")";
        chatMessages.appendChild(messageDiv);
    }          
               
    // Function to load and display messages from publicchat_student.txt
    function loadPublicMessages() {
        // Assuming public_messages is a JSON array obtained from Flask
        var publicMessages = {{ public_messages | safe }};
               
        // Get the current user's username
        var username = "{{ username }}";
               
        // Loop through each message and add it to the chat if the recipient matches the current user
        publicMessages.forEach(function(message) {
            if (message.selectedStudentName === username) {
                addMessage(message.selectedStudentName, message.messageInput, message.timestamp);
            }  
        });    
    }          
               
    // Load public messages when the page is loaded
    document.addEventListener("DOMContentLoaded", function() {
        loadPublicMessages();
    });        
</script>      
<script>       
               
               
    // Pre-populate search bar with sample names
    const searchBar = document.getElementById("search-bar");
    searchBar.value = "Search.."; // Sample search value
               
    // Function to update the dropdown based on search input
    function updateDropdown() {
        const searchInput = searchBar.value.toLowerCase();
        const dropdown = document.getElementById("student-dropdown");
               
        // Clear previous options
        dropdown.innerHTML = "";
               
        // Sample student data (replace this with your actual student data)
    const sampleStudentData = [];
               
// Generate 5000 data points
               
		   const jsonString = '{{ all_usernames | tojson | safe }}';
               
 yourString = "" + jsonString.slice(1, -1) + "";
               
 const dataString = yourString
const dataArray = JSON.parse(dataString);
               
for (let i = 1; i <= dataArray.length; i++) {
    sampleStudentData.push({ name: `Student ${i}` });
}              
// Update sampleStudentData with new names
for (let i = 0; i < Math.min(sampleStudentData.length, dataArray.length); i++) {
    sampleStudentData[i].name = dataArray[i];
}              
               
               
        sampleStudentData.forEach((student) => {
            if (student.name.toLowerCase().includes(searchInput)) {
                const option = document.createElement("option");
                option.text = student.name;
                dropdown.add(option);
            }  
        });    
    }          
               
    document.getElementById("chat-form").addEventListener("submit", function (e) {
        e.preventDefault();
        const selectedStudentId = document.getElementById("student-dropdown").value;
        const selectedStudentName = document.getElementById("student-dropdown").options[document.getElementById("student-dropdown").selectedIndex].text;
        const messageInput = document.getElementById("message-input").value;
        const privacyOption = document.getElementById("privacy-dropdown").value;
		var username = "{{ username }}";
        const usernamee = username;
               
        if (selectedStudentId && messageInput) {
            const messageData = {
                selectedStudentName,
                selectedStudentId,
                privacyOption,
                messageInput,
                usernamee
            }; 
               
            // Convert the data to JSON format
            const jsonData = JSON.stringify(messageData);
               
            // Make an Ajax request to the Flask route
            fetch('/chat_student', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: jsonData,
            }) 
            .then(response => response.json())
            .then(data => {
                // Display the response on the page
                document.getElementById("response-container").innerText = JSON.stringify(data, null, 2);
            }) 
            .catch(error => {
                console.error('Error:', error);
            });
        } else {
            console.error("Please select a student, privacy option, and enter a message.");
        }      
    });        
</script>      
               
               
               
               
    <!----------------------chatbot----------------->
   
               
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.min.js"></script>
    <script src="/static/js/jquery-2.1.3.js"></script>
	
    <script type="text/javascript">
        var socket = io.connect('http://' + document.domain + ':' + location.port);
               
        socket.on('connect', function () {
            socket.emit('my event', {
                data: 'User Connected'
            }) 
            var form = $('form').on('submit', function (e) {
                e.preventDefault()
                let user_name = $('input.username').val()
                let user_input = $('input.message').val()
                socket.emit('my event', {
                    user_name: user_name,
                    message: user_input
                })
                $('input.username').val('').focus()
               
                $('input.message').val('').focus()
            }) 
        })     
        socket.on('my response', function (msg) {
            console.log(msg)
            if (typeof msg.user_name !== 'undefined') {
                $('h3').remove()
                $('div.message-holder').append('<div><b style="color: #000">' + msg.user_name + '</b> ' + msg.message + '</div>')
                // Check if there are no previous chats, and display "Previous Chats" div
                if ($('#previous-chats').is(':hidden')) {
                    $('#previous-chats').show();
                }
               
                // Append the new message
                $('div.message-holder').append(messageDiv)
            }  
        })     
               
        function scrollSection(targetId) {
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                window.scrollTo({
                    top: targetSection.offsetTop,
                    behavior: 'smooth'
                });
               
                const navLinks = document.querySelectorAll('.nav-link');
                navLinks.forEach((link) => {
                    link.classList.remove('active');
                });
               
                const clickedLink = document.querySelector(`[data-target="${targetId}"]`);
                if (clickedLink) {
                    clickedLink.classList.add('active');
                }
            }  
        }      
               
        function sendMessage() {
            var userMessage = document.getElementById('user_input').value;
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/chatbot', true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    var response = xhr.responseText;
                    var chatbox = document.getElementById('chatbox_messages');
               
                    // Create new message elements
                    var userMessageElement = document.createElement('div');
                    userMessageElement.className = 'messages__item messages__item--visitor';
                    userMessageElement.textContent = userMessage;
               
                    var chatbotMessageElement = document.createElement('div');
                    chatbotMessageElement.className = 'messages__item messages__item--operator';
                    chatbotMessageElement.textContent = response;
               
                    // Insert new message elements at the top of the chatbox
                    chatbox.insertBefore(userMessageElement, chatbox.firstChild);
               
                    chatbox.insertBefore(chatbotMessageElement, chatbox.firstChild);
                }
            }; 
            xhr.send('message=' + userMessage);
            // Clear the input field
            document.getElementById('user_input').value = '';
        }      
               
    </script>  
               
    <script src="/static/assets/js/Chat.js"></script>
    <script src="/static/app.js"></script>
               
               
               
               
               
               
               
               
               
</body>        
               
</html>        